####Checking whether paralogs give rise to the same LCR or different
bedtools intersect -wa -wb -a flps_detected_single_chronly_exon_repeats_chr_rpts_combined_compact -b human_protein_coding_genes_coordinates > flps_output_with_gene_names
awk '{print $9}' flps_output_with_gene_names|sort -u > genes_with_lps
cp genes_with_lps genes_with_lps_backup
rm -rf para_temp paraflps shared_flps_output
nummax=`wc -l genes_with_lps|awk '{print $1}'`
for num in `seq 1 $nummax`
do
echo $num
j=`head -n1 genes_with_lps`
echo $j
awk -v g1=$j '$1==g1{print $2}' paralog_list_filtered > para_temp
numpara=`wc -l para_temp|awk '{print $1}'`
allpara=`cat para_temp|sed -z 's/\n/,/g'|sed -r 's/(.*),/\1/'`
echo $j >> para_temp
while read para
do
sed -i "/\b$para\b/d" genes_with_lps
done < para_temp
rm -rf paraflps
while read p
do
awk -v p1=$p '$9==p1{print $0}' OFS="\t" flps_output_with_gene_names >> paraflps
done < para_temp
tot_rpt=`wc -l paraflps|awk '{print $1}'`
shared_rpt=`awk '{print $5}' paraflps|sort|uniq -c|awk '$1>1{print $1}'|awk '{sum+=$1;} END{print sum;}'`
frac=`echo $shared_rpt $tot_rpt|awk '{print $1/$2}'`
echo -e "$j\t$allpara\t$numpara\t$tot_rpt\t$shared_rpt\t$frac" >> shared_flps_output
done

awk 'NF>3{print $0}' OFS="\t" shared_flps_output|awk '{if(NF==5)print $1,"NO_PARA",$2,$3,$4,$5;else print $0}' OFS="\t" shared_flps_output|awk '{if(NF==4)print $1,$2,$3,$4,0,0;else print $0}' OFS="\t"|awk 'NF==6{print $0}' OFS="\t" > shared_flps_paralogs_filtered
