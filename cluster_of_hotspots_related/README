###Making 10Mb non-overlapping windows to pick up cluster of hotspots detected earlier#######################
bedtools makewindows -g chromosomesizes -w 10000000 > abcd
sort -u abcd|sort -k1,1 -k2,2n > human_10mb_windows
rm abcd
bedtools intersect -c -a human_10mb_windows -b hotspots_repeats_50kb.txt|sort -k4nr|head
###We define a cluster of hotspot if number of hotspots in the 10mb windows are more than 5####
##We will use 10mb for further analyses
bedtools intersect -c -a human_10mb_windows -b hotspots_repeats_50kb.txt|awk '$4>5{print $0}' OFS="\t" > coordinates_cluster_hotspot_10mb_windows


###For Chromosome 17 image

bedtools intersect -a hotspots_repeats_50kb.txt -b coordinates_cluster_hotspot_10mb_windows > hotspots_coordinates_within_clusters
##60 hotspots_coordinates_within_clusters
###intersecting with the gene id file to get the gene id of repeat-containing genes in the cluster
bedtools intersect -wa -wb -a hotspots_coordinates_within_clusters -b flps_detected_single_chronly_exon_repeats_chr_rpts_combined_compact|awk '{print $6,$7,$8,$9,$10}' OFS="\t" > genes_in_cluster_hotspot
##252
bedtools intersect -wa -wb -a genes_in_cluster_hotspot -b exon_coordinates > genes_names_in_cluster_hotspot
awk '{print $10}' genes_names_in_cluster_hotspot|sort -u|wc -l
##73 unique genes
